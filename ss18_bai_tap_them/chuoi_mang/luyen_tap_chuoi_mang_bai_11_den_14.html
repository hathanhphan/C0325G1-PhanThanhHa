<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Luyện tập chuỗi - mảng</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@600&family=Noto+Sans:ital,wght@0,400;0,700;1,400;1,700&family=Paytone+One&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <style>
        html {
            scroll-behavior: smooth;
        }
        .font-primary {
            font-family: "Paytone One", sans-serif;
        }
        .font-secondary {
            font-family: "Lexend", sans-serif;
        }
        .btn {
            display: block;
            font-weight: bold;
            padding: 10px 20px;
            border-radius: 10px;
        }
        .btn-blue {
            background-color: cornflowerblue;
            color: white;
        }
        .btn-blue:hover {
            background-color: #2139d6;
            transition: all 0.3s linear;
        }
        .anchor-list li {
            text-align: center;
            margin-bottom: 16px;
            min-width: 100px;
            display: block;
        }
    </style>
</head>
<body>
    <div class="px-4 container">
        <h1 class="font-primary text-2xl mb-2 mt-2 text-blue-800">Luyện tập chuỗi - mảng</h1>
        <ul class="anchor-list my-8 flex gap-4 w-full font-secondary">
            <li>
                <a href="#ex11" class="btn btn-blue">Bài 11</a>
            </li>
            <li>
                <a href="#ex12" class="btn btn-blue">Bài 12</a>
            </li>
            <li>
                <a href="#ex13" class="btn btn-blue">Bài 13</a>
            </li>
            <li>
                <a href="#ex14" class="btn btn-blue">Bài 14</a>
            </li>
            <li>
                <a href="#ex15" class="btn btn-blue">Bài 15</a>
            </li>
        </ul>
    </div>

    <!-- Exercise 11 -->
    <div id="ex11" class="ex11 p-4 container font-secondary text-xl">
        <h2 class="font-primary text-xl mb-4 text-blue-600">Bài 11: Thầy Ba muốn có s cây bút để tặng cho học sinh của mình</h2>
        <p>Ở cửa hàng bán bút CODEGYM đang có khuyến mãi như sau: Khi mua x cây bút sẽ được tặng y cây bút nữa.</p>
        <p><u>Yêu cầu:</u> Hãy đưa ra số bút tối thiểu mà Thầy Ba phải mua để thầy có đủ s cây bút</p>
        <p><u>Input:</u> 1 chuỗi 3 giá trị số nguyên bao gồm x, y và s. Các số cách nhau bởi dấu “,”</p>
        <p><i>Điều kiện 0 < x < 109, 0 < y < 109, 0 < s < 109</i></p>
        <p class="mb-4"><u>Output:</u> 1 giá trị số nguyên là số bút tối thiểu mà Thầy Ba mua</p>
        <form>
            <div class="flex flex-wrap my-5 lg:justify-center">
                <div class="w-40">Nhập chuỗi số</div>
                <div class="w-60 flex-auto">
                    <input type="text" name="str" minlength="1" maxlength="255" pattern="^[0-9\,\s+]*$" title="Chỉ chấp nhận kí tự số, dấu phẩy và dấu cách" required class="w-[360px] border border-gray-300 rounded-md">
                    <span class="italic">(Ví dụ: 2, 1, 6)</span>
                </div>
            </div>
            <div class="bg-blue-200 w-[800px]">
                <p>Kết quả: <span class="output"></span></p>
            </div>
            <div class="flex flex-wrap my-5 justify-left">
                <input type="submit" value="Kiểm tra" class="btnCal hover:cursor-pointer w-full mb-2 lg:mb-0 lg:w-[200px] mr-2 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full">
                <input type="reset" value="Nhập lại" class="hover:cursor-pointer w-full mr-2 lg:w-[200px] bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full">
            </div>
        </form>
    </div>
    <div class="h-5 lg:h-10"></div>

    <!-- Exercise 12 -->
    <div id="ex12" class="ex12 p-4 container font-secondary text-xl">
        <h2 class="font-primary text-xl mb-4 text-blue-600">Bài 12:</h2>
        <p>Để chúc mừng ngày 8/3, các bạn học sinh lớp 12A3 dự định tổ
            chức dã ngoại đến biển Nha Trang và lớp sẽ đi bằng taxi.</p>
        <p>Các bạn trong lớp được chia thành n nhóm, mỗi nhóm
            thứ i gồm x bạn (1 ≤ x ≤ 4 vì mỗi chiếc taxi chở tối đa 4 hành
            khách).</p>
        <p><u>Yêu cầu:</u> Lớp 12A3 cần thuê ít nhất bao nhiêu chiếc taxi để chở các nhóm
            đi, với điều kiện là các bạn trong nhóm phải ngồi chung taxi (một
            taxi có thể chở một nhóm trở lên).</p>
        <p><u>Input:</u> 1 chuỗi chứa dãy số nguyên, mỗi số cách nhau bởi 1 dấu “,”</p>
        <p class="mb-4"><u>Output:</u> Số lượng tối thiểu taxi cần thiết để chở tất cả học sinh đến nơi</p>
        <form>
            <div class="flex flex-wrap my-5 lg:justify-center">
                <div class="w-40">Nhập chuỗi số</div>
                <div class="w-60 flex-auto">
                    <input type="text" name="str" minlength="1" maxlength="255" pattern="^[0-9\,\s+]*$" title="Chỉ chấp nhận kí tự số, dấu phẩy và dấu cách" required class="w-[360px] border border-gray-300 rounded-md">
                    <span class="italic">(Ví dụ: 1 ,2 ,4 ,3 ,3)</span>
                </div>
            </div>
            <div class="bg-blue-200 w-[800px]">
                <p>Kết quả: <span class="output"></span></p>
            </div>
            <div class="flex flex-wrap my-5 justify-left">
                <input type="submit" value="Kiểm tra" class="btnCal hover:cursor-pointer w-full mb-2 lg:mb-0 lg:w-[200px] mr-2 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full">
                <input type="reset" value="Nhập lại" class="hover:cursor-pointer w-full mr-2 lg:w-[200px] bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full">
            </div>
        </form>
    </div>
    <div class="h-5 lg:h-10"></div>

    <!-- Exercise 13 -->
    <div id="ex13" class="ex13 p-4 container font-secondary text-xl">
        <h2 class="font-primary text-xl mb-4 text-blue-600">Bài 13:</h2>
        <p><u>Yêu cầu:</u> Viết phương thức trả về index số lớn thứ nhì trong mảng. Nếu
            không có số lớn nhì thì trả về -1. Nếu có nhiều số lớn nhì thì lấy
            vị trí của số đầu tiên.</p>
        <p><u>Input:</u> 1 chuỗi chứa dãy số nguyên, mỗi số cách nhau bởi 1 dấu “,”</p>
        <p class="mb-4"><u>Output:</u> Index của số lớn thứ 2</p>
        <form>
            <div class="flex flex-wrap my-5 lg:justify-center">
                <div class="w-40">Nhập chuỗi số</div>
                <div class="w-60 flex-auto">
                    <input type="text" name="str" minlength="1" maxlength="255" pattern="^[0-9\-\,\s+]*$" title="Chỉ chấp nhận kí tự số, dấu trừ, dấu phẩy và dấu cách" required class="w-[360px] border border-gray-300 rounded-md">
                    <span class="italic">(Ví dụ: 1 ,2 ,4 ,3 ,3)</span>
                </div>
            </div>
            <div class="bg-blue-200 w-[800px]">
                <p>Kết quả: <span class="output"></span></p>
            </div>
            <div class="flex flex-wrap my-5 justify-left">
                <input type="submit" value="Kiểm tra" class="btnCal hover:cursor-pointer w-full mb-2 lg:mb-0 lg:w-[200px] mr-2 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full">
                <input type="reset" value="Nhập lại" class="hover:cursor-pointer w-full mr-2 lg:w-[200px] bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full">
            </div>
        </form>
    </div>
    <div class="h-5 lg:h-10"></div>

    <!-- Exercise 14 -->
    <div id="ex14" class="ex14 p-4 container font-secondary text-xl">
        <h2 class="font-primary text-xl mb-4 text-blue-600">Bài 14: Viết phương thức đếm số ký tự khác nhau ở chuỗi đầu vào.</h2>
        <form>
            <div class="flex flex-wrap my-5 lg:justify-center">
                <div class="w-40">Nhập chuỗi</div>
                <div class="w-60 flex-auto">
                    <input type="text" name="str" maxlength="255" required class="w-[240px] border border-gray-300 rounded-md">
                </div>
            </div>
            <div class="bg-blue-200 w-[800px]">
                <p>Kết quả: <span class="output"></span></p>
            </div>
            <div class="flex flex-wrap my-5 justify-left">
                <input type="submit" value="Tính toán" class="btnCal hover:cursor-pointer w-full mb-2 lg:mb-0 lg:w-[200px] mr-2 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full">
                <input type="reset" value="Nhập lại" class="hover:cursor-pointer w-full mr-2 lg:w-[200px] bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full">
            </div>
        </form>
    </div>
    <div class="h-5 lg:h-10"></div>

    <script>
        function validateLength(selector, displayName, min = 0, max) {
            let input = document.querySelector(selector);
            if (input.value.length < min || input.value.length > max) {
                alert(`Bạn cần nhập ${displayName} có độ dài trong khoảng từ ${min} đến ${max} kí tự!`);
                return false;
            }
            return true;
        }
        function validate(selector, displayName, min, max) {
            let input = document.querySelector(selector);
            if (isNaN(parseFloat(input.value))) {
                alert(`Bạn cần nhập ${displayName} là số!`);
                return false;
            } else if (parseFloat(input.value) < min || parseFloat(input.value) > max) {
                alert(`Bạn cần nhập ${displayName} trong khoảng từ ${min} đến ${max}!`);
                return false;
            }
            return true;
        }
        function validateRegex(str, regex, errorMessage) {
            if (!str.match(regex)) {
                alert(errorMessage);
                return false;
            }
            return true;
        }

        // Exercise 11
        document.querySelector('.ex11 form').addEventListener('submit', function(e) {
            e.preventDefault();
            let output = document.querySelector('.ex11 .output');
            let str = document.querySelector('.ex11 input[name="str"]').value;
            const regex = /^[0-9\\,\s+]*$/;
            if (!validateLength('.ex11 input[name="str"]', 'chuỗi số', 1, 255)
                || !validateRegex(str, regex, "Chỉ chấp nhận kí tự số, dấu phẩy và khoảng trắng")) {
                return;
            }
            output.innerHTML = "";
            str = str.replace(/\s+/, '');
            let arr = str.split(',').map(x => +x);
            if (arr.length !== 3) {
                alert("Vui lòng nhập chuỗi 3 giá trị hợp lệ như input của đề bài!");
                return;
            }
            if (!arr.every(item => item > 0 && item < 109)) {
                alert("Vui lòng nhập giá trị của 3 phần tử trong khoảng 0 < x,y,s < 109!");
                return;
            }
            output.innerHTML = promotion(...arr).toString();
        })
        function promotion(x, y, s) {
            let numNeedToBuy = 0;
            // let count = 0;
            // let i = 1;
            // while (count !== s) {
            //     if (x * i + y * i === s) {
            //         numNeedToBuy = x * i;
            //     } else if (s - (x * i + y * i) < x) {
            //         let needBuyMore = s - (x * i + y * i);
            //         if (needBuyMore > 0) {
            //             numNeedToBuy = x * i + needBuyMore;
            //         } else {
            //             numNeedToBuy = x * i;
            //         }
            //         break;
            //     }
            //     count = x * i + y * i;
            //     i++;
            // }
            if (x >= s) {
                return s;
            }
            let timesBuyWithBonus = Math.ceil(s / (x + y));
            let numBuyWithoutBonus = s - (x * timesBuyWithBonus + y * timesBuyWithBonus);
            if (numBuyWithoutBonus > 0) {
                numNeedToBuy = numBuyWithoutBonus + x * timesBuyWithBonus;
            } else {
                if (y - x > numBuyWithoutBonus && x < s) {
                    numNeedToBuy = x * (timesBuyWithBonus - 1) + (x - y);
                } else {
                    numNeedToBuy = x * timesBuyWithBonus;
                }
            }
            return numNeedToBuy;
        }

        // Exercise 12
        document.querySelector('.ex12 form').addEventListener('submit', function(e) {
            e.preventDefault();
            let output = document.querySelector('.ex12 .output');
            let str = document.querySelector('.ex12 input[name="str"]').value;
            const regex = /^[0-9\\,\s+]*$/;
            if (!validateLength('.ex12 input[name="str"]', 'chuỗi số', 1, 255)
                || !validateRegex(str, regex, "Chỉ chấp nhận kí tự số, dấu phẩy và khoảng trắng")) {
                return;
            }
            output.innerHTML = "";
            str = str.replace(/\s+/, '');
            let arr = str.split(',').map(x => +x);
            if (!arr.every(item => item > 0 && item <= 4)) {
                alert("Vui lòng nhập số lượng thành viên của mỗi nhóm trong khoảng 0 < x <= 4");
                return;
            }
            arr.sort((a, b) => a - b);
            output.innerHTML += taxi(arr).toString();
        })
        function taxi(arr) {
            let max = 4;
            let tempGroup = 0;
            let count = 0;
            for (let i = 0; i < arr.length; i++) {
                if (tempGroup + arr[i] === max) {
                    count++;
                    tempGroup = 0;
                } else if (tempGroup + arr[i] > max) {
                    count++;
                    tempGroup = 0;
                    --i;
                } else {
                    tempGroup = tempGroup + arr[i];
                }
            }
            if (tempGroup > 0) {
                count++;
            }
            return count;
        }

        // Exercise 13
        document.querySelector('.ex13 form').addEventListener('submit', function(e) {
            e.preventDefault();
            let output = document.querySelector('.ex13 .output');
            let str = document.querySelector('.ex13 input[name="str"]').value;
            const regex = /^[0-9\\,\s+]*$/;
            if (!validateLength('.ex13 input[name="str"]', 'chuỗi số', 1, 255)
                || !validateRegex(str, regex, "Chỉ chấp nhận kí tự số, dấu trừ, dấu phẩy và khoảng trắng")) {
                return;
            }
            output.innerHTML = "";
            str = str.replace(/\s+/, '');
            let arr = str.split(',').map(x => +x);
            if (arr.length < 1) {
                alert("Vui lòng nhập chuỗi số ít nhất 2 phần tử");
                return;
            }
            if (!arr.every(item => item > -999999 && item <= 999999)) {
                alert("Vui lòng nhập số lượng thành viên của mỗi nhóm trong khoảng -999999 < x <= 999999");
                return;
            }
            output.innerHTML = findSecondMax(arr).toString();
        })
        function findSecondMax(arr) {
            let max = arr[0];
            let secondMax = null;
            let maxIndex = 0;
            let secondMaxIndex = -1;
            for (let i = 1; i < arr.length; i++) {
                if (arr[i] < max) {
                    if (secondMax === null || arr[i] > secondMax) {
                        secondMax = arr[i];
                        secondMaxIndex = i;
                    }
                } else if (arr[i] > max) {
                    secondMax = max;
                    secondMaxIndex = maxIndex;
                    max = arr[i];
                    maxIndex = i;
                }
            }
            //console.log(max, secondMax);
            return secondMaxIndex;
        }

        // Exercise 14
        document.querySelector('.ex14 form').addEventListener('submit', function(e) {
            e.preventDefault();
            let output = document.querySelector('.ex14 .output');
            let str = document.querySelector('.ex14 input[name="str"]').value;
            if (!validateLength('.ex14 input[name="str"]', 'chuỗi', 1, 255)) {
                return;
            }
            let arr = str.split('');
            let counterArr = countOccurrences([], 'arr', arr, 'id')
            output.innerHTML = "";
            output.innerHTML = counterArr.length.toString();
        })
        function countOccurrences(counterArr, counterKey, arr, key) {
            arr.forEach(item => {
                let index = counterArr.findIndex(x => x[key] === item)
                if (index > -1) {
                    if (counterArr[index][counterKey] === undefined) {
                        counterArr[index][counterKey] = 1;
                    } else {
                        counterArr[index][counterKey] += 1;
                    }
                } else {
                    counterArr.push({
                        [key]: item,
                        [counterKey]: 1
                    });
                }
            });
            return counterArr;
        }
    </script>
</body>
</html>